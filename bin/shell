#!/bin/zsh
# SPDX-License-Identifier: MIT
# Copyright (c) 2025 Stuart Alldred. All Rights Reserved

# Check for EUMOS_ROOT already being set in the shell
if [[ "$EUMOS_ROOT" != "" ]]; then
    echo "[\033[0;31mERROR\033[0m] Eumos shell is already activated!"
    exit 1
fi

# Work out where the repository is located
EUMOS_ROOT=$(readlink -f ${0:a:h}/..)

USER_HISTFILE=${HISTFILE:-$HOME/.zsh_history}

EUMOS_ROOT=$EUMOS_ROOT \
    USER_HISTFILE=$USER_HISTFILE \
    ZDOTDIR=$EUMOS_ROOT/bin/zsh \
    /bin/zsh -i $@
